<!doctype html><html lang="en-US"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.24" /><meta name="theme" content="VuePress Theme Plume 1.0.0-rc.158" /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><link rel="icon" href="/wan-s-blog/favicon.ico"><link rel="icon" href="/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/wan-s-blog/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico"><title>HDFS Reset Complete Guide: Safe Recovery and Data Protection | WAN's Blog</title><meta name="description" content="WAN's blog"><link rel="preload" href="/wan-s-blog/assets/style-Dlml69BT.css" as="style"><link rel="stylesheet" href="/wan-s-blog/assets/style-Dlml69BT.css"><link rel="modulepreload" href="/wan-s-blog/assets/app-C7AwxLk6.js"><link rel="modulepreload" href="/wan-s-blog/assets/index.html-uQtNVhik.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-d90a7a26><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-d5a8d0bc></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-d5a8d0bc> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-d90a7a26 data-v-e98a6132><div class="vp-navbar" vp-navbar data-v-e98a6132 data-v-2c31ea5e><div class="wrapper" data-v-2c31ea5e><div class="container" data-v-2c31ea5e><div class="title" data-v-2c31ea5e><div class="vp-navbar-title" data-v-2c31ea5e data-v-1a4f50af><a class="vp-link link no-icon title" href="/wan-s-blog/" data-v-1a4f50af><!--[--><!--[--><!--]--><!----><span data-v-1a4f50af>WAN&#39;s Blog</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-2c31ea5e><div class="content-body" data-v-2c31ea5e><!--[--><!--]--><div class="vp-navbar-search search" data-v-2c31ea5e><div class="search-wrapper" data-v-97535d1e><!----><div id="local-search" data-v-97535d1e><button type="button" class="mini-search mini-search-button" aria-label="Search" data-v-97535d1e><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">Search</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><!--[--><!--]--><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-2c31ea5e data-v-d43c1732><span id="main-nav-aria-label" class="visually-hidden" data-v-d43c1732>Main Navigation</span><!--[--><!--[--><a class="vp-link link navbar-menu-link" href="/wan-s-blog/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><span class="vp-icon vpi-2gpyrm9q" style="" aria-hidden data-provider="iconify" data-v-d4acf911></span><span data-v-d4acf911>Home</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/wan-s-blog/blog/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><span class="vp-icon vpi-87rag0z2" style="" aria-hidden data-provider="iconify" data-v-d4acf911></span><span data-v-d4acf911>Blog</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/wan-s-blog/blog/tags/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><span class="vp-icon vpi-s5w0hi5n" style="" aria-hidden data-provider="iconify" data-v-d4acf911></span><span data-v-d4acf911>Tags</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/wan-s-blog/blog/archives/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><span class="vp-icon vpi-yf0gznx9" style="" aria-hidden data-provider="iconify" data-v-d4acf911></span><span data-v-d4acf911>Archives</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/wan-s-blog/notes/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><span class="vp-icon vpi-n0z1b697" style="" aria-hidden data-provider="iconify" data-v-d4acf911></span><span data-v-d4acf911>Notes</span><!----><!--]--><!----></a><!--]--><!--]--></nav><!--[--><!--]--><div class="vp-flyout vp-navbar-translations translations" data-v-2c31ea5e data-v-0d45479b data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Languages" data-v-86530b6c><span class="text" data-v-86530b6c><!----><span class="vpi-languages option-icon" data-v-86530b6c></span><!----><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><!----><!--[--><!--[--><div class="items" data-v-0d45479b><p class="title" data-v-0d45479b>English</p><!--[--><div class="vp-menu-link" data-v-0d45479b data-v-1ff1855f><a class="vp-link link" href="/wan-s-blog/zh-TW/article/xoezzczl/" data-v-1ff1855f><!--[--><!----> 繁體中文 <!----><!--]--><!----></a></div><div class="vp-menu-link" data-v-0d45479b data-v-1ff1855f><a class="vp-link link" href="/wan-s-blog/zh-CN/article/xoezzczl/" data-v-1ff1855f><!--[--><!----> 简体中文 <!----><!--]--><!----></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="vp-navbar-appearance appearance" data-v-2c31ea5e data-v-a295abf6><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-a295abf6 data-v-596c25a9 data-v-7eb32327><span class="check" data-v-7eb32327><span class="icon" data-v-7eb32327><!--[--><span class="vpi-sun sun" data-v-596c25a9></span><span class="vpi-moon moon" data-v-596c25a9></span><!--]--></span></span></button></div><div class="vp-social-links vp-navbar-social-links social-links" data-v-2c31ea5e data-v-ad52545c data-v-40bac536><!--[--><a class="vp-social-link no-icon" href="https://github.com/yunfenglong" aria-label="github" target="_blank" rel="noopener" data-v-40bac536 data-v-67b21932><span class="vpi-social-github" /></a><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-2c31ea5e data-v-652282fd data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-86530b6c><span class="vpi-more-horizontal icon" data-v-86530b6c></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><!----><!--[--><!--[--><!----><div class="group" data-v-652282fd><div class="item appearance" data-v-652282fd><p class="label" data-v-652282fd>Appearance</p><div class="appearance-action" data-v-652282fd><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-652282fd data-v-596c25a9 data-v-7eb32327><span class="check" data-v-7eb32327><span class="icon" data-v-7eb32327><!--[--><span class="vpi-sun sun" data-v-596c25a9></span><span class="vpi-moon moon" data-v-596c25a9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-652282fd><div class="item social-links" data-v-652282fd><div class="vp-social-links social-links-list" data-v-652282fd data-v-40bac536><!--[--><a class="vp-social-link no-icon" href="https://github.com/yunfenglong" aria-label="github" target="_blank" rel="noopener" data-v-40bac536 data-v-67b21932><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-2c31ea5e data-v-2b50024d><span class="container" data-v-2b50024d><span class="top" data-v-2b50024d></span><span class="middle" data-v-2b50024d></span><span class="bottom" data-v-2b50024d></span></span></button></div></div></div></div><div class="divider" data-v-2c31ea5e><div class="divider-line" data-v-2c31ea5e></div></div></div><!----></header><div class="vp-local-nav fixed reached-top is-blog" data-v-d90a7a26 data-v-3944d8e8><button class="hidden menu" disabled aria-expanded="false" aria-controls="SidebarNav" data-v-3944d8e8><span class="vpi-align-left menu-icon" data-v-3944d8e8></span><span class="menu-text" data-v-3944d8e8>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-3944d8e8 data-v-4114a62c><button data-v-4114a62c>Return to top</button><!----></div></div><!----><!--[--><div id="VPContent" vp-content class="vp-content" data-v-d90a7a26 data-v-b2beaca7><div class="vp-doc-container is-blog" data-v-b2beaca7 data-v-23f6ad98><!--[--><!--]--><div class="container" data-v-23f6ad98><!----><div class="content" data-v-23f6ad98><div class="content-container" data-v-23f6ad98><!--[--><!--]--><main class="main" data-v-23f6ad98><nav class="vp-breadcrumb" data-v-23f6ad98 data-v-1ae4ad7a><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-1ae4ad7a><!--[--><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb" href="/wan-s-blog/" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->Home<!--]--><!----></a><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="Home" data-v-1ae4ad7a><meta property="position" content="1" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb" href="/wan-s-blog/blog/" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->Blog<!--]--><!----></a><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="Blog" data-v-1ae4ad7a><meta property="position" content="2" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb" href="/wan-s-blog/blog/categories/?id=162e99" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->Hands-On Workshop<!--]--><!----></a><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="Hands-On Workshop" data-v-1ae4ad7a><meta property="position" content="3" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb current" href="/wan-s-blog/article/xoezzczl/" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->HDFS Reset Complete Guide: Safe Recovery and Data Protection<!--]--><!----></a><!----><meta property="name" content="HDFS Reset Complete Guide: Safe Recovery and Data Protection" data-v-1ae4ad7a><meta property="position" content="4" data-v-1ae4ad7a></li><!--]--></ol></nav><!--[--><!--]--><!--[--><h1 class="vp-doc-title page-title" data-v-27be53cb>HDFS Reset Complete Guide: Safe Recovery and Data Protection <!----></h1><div class="vp-doc-meta" data-v-27be53cb><!--[--><!--]--><p class="reading-time" data-v-27be53cb><span class="vpi-books icon" data-v-27be53cb></span><span data-v-27be53cb>About 643 words</span><span data-v-27be53cb>About 8 min</span></p><p data-v-27be53cb><span class="vpi-tag icon" data-v-27be53cb></span><!--[--><a class="vp-link link tag vp-tag-1nfv" href="/wan-s-blog/blog/tags/?tag=Hadoop" data-v-27be53cb><!--[-->Hadoop<!--]--><!----></a><a class="vp-link link tag vp-tag-lscd" href="/wan-s-blog/blog/tags/?tag=HDFS" data-v-27be53cb><!--[-->HDFS<!--]--><!----></a><!--]--></p><!--[--><!--]--><p class="create-time" data-v-27be53cb><span class="vpi-clock icon" data-v-27be53cb></span><span data-v-27be53cb>2025-04-08</span></p></div><!--]--><!--[--><!--]--><div class="_article_xoezzczl_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-23f6ad98><!--[--><!--]--><div data-v-23f6ad98><h2 id="overview" tabindex="-1"><a class="header-anchor" href="#overview"><span>Overview</span></a></h2><p>Resetting Hadoop HDFS (Hadoop Distributed File System) is a critical operation that system administrators may need to perform in various scenarios. Whether you&#39;re recovering from a system failure, troubleshooting data corruption issues, or preparing a clean environment for testing, understanding how to safely reset HDFS is essential.</p><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>HDFS reset operations involve data manipulation that could potentially lead to data loss if not performed correctly. Always ensure you have proper backups and understand the implications before proceeding.</p></div><h2 id="prerequisites" tabindex="-1"><a class="header-anchor" href="#prerequisites"><span>Prerequisites</span></a></h2><p>Before attempting any HDFS reset operation, ensure you have:</p><ol><li><strong>Backup your data</strong>: Always create backups of important data before performing reset operations</li><li><strong>Stop running services</strong>: Stop all Hadoop services to prevent conflicts during the reset</li><li><strong>Check cluster status</strong>: Verify the current health status of your HDFS cluster</li><li><strong>Document current configuration</strong>: Save your current configuration files for reference</li></ol><h2 id="step-by-step-hdfs-reset-process" tabindex="-1"><a class="header-anchor" href="#step-by-step-hdfs-reset-process"><span>Step-by-Step HDFS Reset Process</span></a></h2><h3 id="step-1-stop-hadoop-services" tabindex="-1"><a class="header-anchor" href="#step-1-stop-hadoop-services"><span>Step 1: Stop Hadoop Services</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Stop all Hadoop services</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">stop-dfs.sh</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">stop-yarn.sh</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mr-jobhistory-daemon.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> stop</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> historyserver</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="vp-steps"><ul><li>Verify all services are stopped using <code>jps</code> command</li><li>Check for any remaining processes and manually terminate if necessary</li></ul></div><h3 id="step-2-clear-hdfs-data" tabindex="-1"><a class="header-anchor" href="#step-2-clear-hdfs-data"><span>Step 2: Clear HDFS Data</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Format the HDFS filesystem</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">hdfs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> namenode</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -format</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Optional: Clear the data directories manually</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">rm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -rf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/hadoop/hdfs/namenode/</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">rm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -rf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/hadoop/hdfs/datanode/</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">rm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -rf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /tmp/hadoop-</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>Use <code>rm -rf</code> with caution as it permanently deletes files. Double-check the paths before execution.</p></div><h3 id="step-3-recreate-hdfs-directory-structure" tabindex="-1"><a class="header-anchor" href="#step-3-recreate-hdfs-directory-structure"><span>Step 3: Recreate HDFS Directory Structure</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Create necessary directories</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -p</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/hadoop/hdfs/namenode</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -p</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/hadoop/hdfs/datanode</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -p</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /tmp/hadoop-</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">whoami</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Set proper permissions</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">chown</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -R</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">whoami</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">whoami</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/hadoop/hdfs</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">chown</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -R</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">whoami</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">whoami</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /tmp/hadoop-</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">whoami</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="step-4-restart-hadoop-services" tabindex="-1"><a class="header-anchor" href="#step-4-restart-hadoop-services"><span>Step 4: Restart Hadoop Services</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Format HDFS (if not already done)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">hdfs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> namenode</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -format</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Start HDFS services</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">start-dfs.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Start YARN services</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">start-yarn.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Start HistoryServer</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mr-jobhistory-daemon.sh</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> start</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> historyserver</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="vp-steps"><ul><li>Monitor the startup process for any errors</li><li>Check service status using <code>jps</code></li><li>Verify HDFS is running properly using <code>hdfs dfsadmin -report</code></li></ul></div><h2 id="verification-steps" tabindex="-1"><a class="header-anchor" href="#verification-steps"><span>Verification Steps</span></a></h2><p>After completing the reset process, verify your HDFS cluster is functioning correctly:</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Check HDFS report</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">hdfs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dfsadmin</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -report</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># List root directory</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">hdfs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dfs</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -ls</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Test file operations</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">hdfs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dfs</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -mkdir</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /test</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">hdfs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dfs</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -put</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/passwd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /test/passwd</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">hdfs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dfs</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -cat</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /test/passwd</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="common-issues-and-solutions" tabindex="-1"><a class="header-anchor" href="#common-issues-and-solutions"><span>Common Issues and Solutions</span></a></h2><h3 id="issue-1-namenode-format-issues" tabindex="-1"><a class="header-anchor" href="#issue-1-namenode-format-issues"><span>Issue 1: NameNode Format Issues</span></a></h3><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>If you encounter &quot;Incompatible filesystem&quot; errors, you may need to perform a clean format:</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Stop services</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">stop-dfs.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Clean directories</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">rm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -rf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/hadoop/hdfs/namenode/</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">rm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -rf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/hadoop/hdfs/datanode/</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Format and restart</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">hdfs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> namenode</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -format</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">start-dfs.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h3 id="issue-2-permission-denied-errors" tabindex="-1"><a class="header-anchor" href="#issue-2-permission-denied-errors"><span>Issue 2: Permission Denied Errors</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Fix permissions</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> chown</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -R</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">whoami</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">whoami</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/hadoop/hdfs</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> chown</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -R</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> $(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">whoami</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">whoami</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /tmp/hadoop-</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="issue-3-datanode-registration-failed" tabindex="-1"><a class="header-anchor" href="#issue-3-datanode-registration-failed"><span>Issue 3: Datanode Registration Failed</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Remove datanode ID and restart</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">rm</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -rf</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/hadoop/hdfs/datanode/current</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">stop-dfs.sh</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">start-dfs.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="backup-and-recovery-strategies" tabindex="-1"><a class="header-anchor" href="#backup-and-recovery-strategies"><span>Backup and Recovery Strategies</span></a></h2><h3 id="creating-backups" tabindex="-1"><a class="header-anchor" href="#creating-backups"><span>Creating Backups</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Backup HDFS configuration</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">cp</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -r</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/hadoop</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/hadoop-config-backup-</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">date</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> +%Y%m%d</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Backup important data from HDFS</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">hdfs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dfs</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -cp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /user/hadoop/input</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /user/hadoop/input-backup</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="recovery-procedures" tabindex="-1"><a class="header-anchor" href="#recovery-procedures"><span>Recovery Procedures</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Restore configuration (if needed)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">cp</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -r</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ~/hadoop-config-backup-</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/hadoop</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /etc/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># Restore data (if backed up)</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">hdfs</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> dfs</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -cp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /user/hadoop/input-backup/</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /user/hadoop/input/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="best-practices" tabindex="-1"><a class="header-anchor" href="#best-practices"><span>Best Practices</span></a></h2><ol><li><strong>Always backup first</strong>: Never perform a reset without proper backups</li><li><strong>Test in staging</strong>: Test reset procedures in a staging environment first</li><li><strong>Document everything</strong>: Keep detailed records of all operations</li><li><strong>Monitor performance</strong>: After reset, monitor cluster performance closely</li><li><strong>Update documentation</strong>: Update your cluster documentation with any configuration changes</li></ol><h2 id="safety-considerations" tabindex="-1"><a class="header-anchor" href="#safety-considerations"><span>Safety Considerations</span></a></h2><p><em>This guide provides a comprehensive approach to HDFS reset operations. Always adapt procedures to your specific environment and requirements.</em></p><div class="hint-container caution"><p class="hint-container-title">Caution</p><p>⚠️ <strong>WARNING</strong>: HDFS reset operations are irreversible and will result in data loss if:</p><ul><li>You haven&#39;t backed up your data</li><li>You execute commands on the wrong paths</li><li>You skip verification steps</li></ul><p>Always double-check:</p><ul><li>File paths before deletion</li><li>Service status before operations</li><li>Backup completeness before reset</li></ul></div></div><!----><!--[--><h2 id="doc-changelog" tabindex="-1"><a href="#doc-changelog" class="header-anchor"><span>Changelog</span></a></h2><div class="vp-changelog-wrapper"><div class="vp-changelog-header"><div class="vp-latest-updated"><span class="vp-changelog-icon"></span><span data-allow-mismatch>8/8/25, 1:17 PM</span></div><div><span class="vp-changelog-menu-icon"></span><span>View All Changelog</span></div></div><ul class="vp-changelog-list"><!--[--><li class="vp-changelog-item-commit"><span class="vp-changelog-hash" target="_blank" rel="noreferrer"><code>7a6b9</code></span><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">feat: introduce new section Hadoop</span><span class="vp-changelog-date" data-allow-mismatch>on <time datetime="2025-08-08T13:17:52.000Z">8/8/25</time></span></li><!--]--></ul></div><!--]--><div class="vp-doc-copyright" data-v-23f6ad98><h2 id="doc-copyright" tabindex="-1" class="vp-doc-header" data-v-309da98c><a href="#doc-copyright" class="header-anchor" data-v-309da98c><span data-v-309da98c><!--[-->Copyright<!--]--></span></a></h2><div class="hint-container tip copyright-container" data-v-22c67d2a><p data-v-22c67d2a><span data-v-22c67d2a>Copyright Ownership:</span><a class="vp-link link no-icon" href="https://github.com/yunfenglong" target="_blank" rel="noreferrer" data-v-22c67d2a><!--[-->WARREN Y.F. LONG<!--]--><!----></a></p><!----><p data-v-22c67d2a><span data-v-22c67d2a>License under:</span><a class="vp-link link no-icon" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="noreferrer" data-v-22c67d2a><!--[-->Attribution-NonCommercial-NoDerivatives 4.0 International (CC-BY-NC-ND-4.0)<!--]--><!----></a><!--[--><span class="vpi-license-cc" data-v-22c67d2a></span><span class="vpi-license-by" data-v-22c67d2a></span><span class="vpi-license-nc" data-v-22c67d2a></span><span class="vpi-license-nd" data-v-22c67d2a></span><!--]--></p></div></div></div></main><footer class="vp-doc-footer" data-v-23f6ad98 data-v-fda6bbae><!--[--><!--]--><!----><!----><nav class="prev-next" data-v-fda6bbae><div class="pager" data-v-fda6bbae><a class="vp-link link pager-link prev" href="/wan-s-blog/quick-bytes/pzwk9jri/" data-v-fda6bbae><!--[--><span class="desc" data-v-fda6bbae>Previous page</span><span class="title" data-v-fda6bbae>Monitoring K8S Service Resource Usage: A Complete Guide</span><!--]--><!----></a></div><div class="pager" data-v-fda6bbae><a class="vp-link link pager-link next" href="/wan-s-blog/article/8mjmh68o/" data-v-fda6bbae><!--[--><span class="desc" data-v-fda6bbae>Next page</span><span class="title" data-v-fda6bbae>HDFS Introduction: Architecture, Components, and Best Practices</span><!--]--><!----></a></div></nav></footer><!----><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-d90a7a26 data-v-bcf8d9a6><span class="percent" data-allow-mismatch data-v-bcf8d9a6>0%</span><span class="show icon vpi-back-to-top" data-v-bcf8d9a6></span><svg aria-hidden="true" data-v-bcf8d9a6><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-bcf8d9a6></circle></svg></button><footer class="vp-footer" vp-footer data-v-d90a7a26 data-v-400675cf><!--[--><div class="container" data-v-400675cf><p class="message" data-v-400675cf>Power by <a target="_blank" href="https://v2.vuepress.vuejs.org/">VuePress</a> & <a target="_blank" href="https://theme-plume.vuejs.press">vuepress-theme-plume</a></p><!----></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/wan-s-blog/assets/app-C7AwxLk6.js" defer></script></body></html>