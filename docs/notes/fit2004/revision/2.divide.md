---
title: Divide and Conquer
createTime: 2025/06/06 11:21:13
permalink: /fit2004/ukjiw9xn/
---

### Karatsuba's Algorithm

:::note Problem Setup
Let's say you want to multiply two large numbers, $x$ and $y$. We can split each of these numbers into two halves. For simplicity, let's assume they both have an even number of digits, $n$.
:::

**Number Representation:**
- $x = a \cdot 10^{\frac{n}{2}} + b$
- $y = c \cdot 10^{\frac{n}{2}} + d$

Where:
- $a$ and $c$ are the ==first halves== of the numbers
- $b$ and $d$ are the ==second halves== of the numbers

**Standard Multiplication:**

$x \cdot y = (a \cdot 10^{n/2} + b)(c \cdot 10^{n/2} + d)$

$x \cdot y = (ac) \cdot 10^n + (ad + bc) \cdot 10^{n/2} + bd$

:::tip The Clever Trick
Instead of **four multiplications**, Karatsuba's method requires only **three**:

1. Calculate $z_2 = a \cdot c$
2. Calculate $z_0 = b \cdot d$  
3. Calculate $z_1 = (a + b) \cdot (c + d)$

Then: $(ad + bc) = z_1 - z_2 - z_0$
:::

```python
def karatsuba(x, y):
    """
    Performs multiplication of two integers using the Karatsuba algorithm.
    """
    # Base case for recursion: if the numbers are small, use standard multiplication.
    # The threshold of 10 is arbitrary; for very small numbers, the overhead
    # of recursion can be greater than the benefit of the algorithm.
    if x < 10 or y < 10:
        return x * y

    # Determine the size of the numbers in terms of number of digits.
    # We use the larger of the two numbers to determine the split point.
    n = max(len(str(x)), len(str(y)))
    
    # To ensure the numbers can be split as evenly as possible, we take
    # the ceiling of n/2.
    n_half = n // 2

    # Split the numbers into two halves.
    # 10**n_half is used as the splitting point.
    # For x = a * 10**(n/2) + b, a = x // 10**n_half and b = x % 10**n_half
    a = x // (10**n_half)
    b = x % (10**n_half)
    c = y // (10**n_half)
    d = y % (10**n_half)

    # The three recursive multiplication steps of the algorithm.
    # z2 = a * c
    z2 = karatsuba(a, c)

    # z0 = b * d
    z0 = karatsuba(b, d)

    # z1 = (a + b) * (c + d)
    z1 = karatsuba(a + b, c + d)

    # Calculate the middle term using the results of the three multiplications:
    # (ad + bc) = z1 - z2 - z0
    middle_term = z1 - z2 - z0

    # Assemble the final product using Karatsuba's formula:
    # result = (z2 * 10**(2 * n_half)) + (middle_term * 10**n_half) + z0
    # Note: 2 * n_half may be n or n-1 depending on whether n is even or odd,
    # which is correctly handled by this power calculation.
    result = (z2 * 10**(2 * n_half)) + (middle_term * 10**n_half) + z0
    
    return result
```